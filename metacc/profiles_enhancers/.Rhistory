foo.acc <- acc_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_acc","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(acc.stats, by="id_acc") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.acc, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=1, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Accessibility (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.85,1.75)) +
theme(
strip.background = element_rect(fill="#00BFC4"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_acc_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
met.stats <- fread(io$met.stats) %>% .[,c("id_met","mean")] %>% .[,context:="CG"]
acc.stats <- fread(io$acc.stats) %>% .[,c("id_acc","mean")] %>% .[,context:="GC"]
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=0.5, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.acc <- acc_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_acc","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(acc.stats, by="id_acc") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.acc, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=0.5, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Accessibility (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.85,1.75)) +
theme(
strip.background = element_rect(fill="#00BFC4"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_acc_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
opts$height = 5
met.stats <- fread(io$met.stats) %>% .[,c("id_met","mean")] %>% .[,context:="CG"]
acc.stats <- fread(io$acc.stats) %>% .[,c("id_acc","mean")] %>% .[,context:="GC"]
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.acc <- acc_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_acc","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(acc.stats, by="id_acc") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.acc, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=0.5, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Accessibility (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
coord_cartesian(ylim=c(0.85,1.75)) +
theme(
strip.background = element_rect(fill="#00BFC4"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/boxplots_acc_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met
my_comparisons <- list(
c("E4.5 Epiblst", "E5.5 Epiblast"),
c("E5.5 Epiblst", "E6.5 Epiblast"),
c("E6.5 Epiblst", "E7.5 Ectoderm"),
)
my_comparisons <- list(
c("E4.5 Epiblst", "E5.5 Epiblast"),
c("E5.5 Epiblst", "E6.5 Epiblast"),
c("E6.5 Epiblst", "E7.5 Ectoderm")
)
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons) +
coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
# dev.off()
my_comparisons
my_comparisons <- list(
c("E4.5 Epiblast", "E5.5 Epiblast"),
c("E5.5 Epiblast", "E6.5 Epiblast"),
c("E6.5 Epiblast", "E7.5 Ectoderm")
)
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons) +
coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
# dev.off()
?stat_compare_means
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons) +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons,
aes(label = paste0("p = ", ..p.format..)), method="t.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="t.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test", tip.length=0) +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
# dev.off()
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test", bracket.size=0) +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_met_top250_scaled.pdf"), width=opts$width, height=opts$height)
print(p)
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test", bracket.size = 0.5) +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test", bracket.size = 0.25) +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.format..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.met <- met_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_met","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(met.stats, by="id_met") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.met, x = "stage_lineage", y = "norm_rate", fill="grey80", outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Methylation (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.1,1.15)) +
theme(
strip.background = element_rect(fill="#F37A71"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.acc <- acc_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_acc","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(acc.stats, by="id_acc") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.acc, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=0.5, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Accessibility (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
coord_cartesian(ylim=c(0.85,1.75)) +
theme(
strip.background = element_rect(fill="#00BFC4"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
foo.acc <- acc_dt %>%
.[,.(rate=100*(sum(Nmet)/sum(Ntotal))),by=c("id_acc","stage_lineage","anno")] %>%
.[,stage_lineage:=factor(stage_lineage, levels=names(opts$colors))] %>%
merge(acc.stats, by="id_acc") %>%
.[,norm_rate:=rate/mean]
p <- ggboxplot(foo.acc, x = "stage_lineage", y = "norm_rate", fill="grey80", coef=0.5, outlier.shape=NA) +
scale_fill_manual(values=opts$colors) +
geom_hline(yintercept=1, linetype="dashed", alpha=0.75, size=0.75) +
labs(x="", y="Accessibility (scaled)") +
facet_wrap(~anno, nrow=1, scales="fixed") +
stat_compare_means(comparisons = my_comparisons, aes(label = ..p.signif..), method="wilcox.test") +
# coord_cartesian(ylim=c(0.85,1.75)) +
theme(
strip.background = element_rect(fill="#00BFC4"),
# axis.text.x = element_text(size=rel(0.9), color="black"),
axis.text.x = element_blank(),
axis.title.y = element_text(size=rel(1.4), color="black"),
strip.text = element_text(size=rel(1.3), color="black"),
legend.position = "none"
)
# pdf(paste0(io$outdir,"/boxplots_acc_top250_scaled.pdf"), width=opts$width, height=opts$height)
pdf(paste0(io$outdir,"/foo.pdf"), width=opts$width, height=opts$height)
print(p)
dev.off()
